<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Martini by Nidhi | Baby Shower, Corporate Gifts & Crystal Healing</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    
    <!-- GSAP for Magnetic Animation -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

    <!-- Firebase Imports (Compat versions) -->
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

    <style>
        /* Custom Font Settings */
        h1, h2, h3, h4, h5, h6 { font-family: 'Playfair Display', serif; }
        body { font-family: 'Lato', sans-serif; -webkit-tap-highlight-color: transparent; }
        
        /* Animations */
        .fade-in { animation: fadeIn 1.2s ease-in-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Menu Slide Animation */
        .slide-down { animation: slideDown 0.3s ease-out forwards; }
        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Loading Spinner */
        .loader {
            border: 3px solid #f3f3f3;
            border-radius: 50%;
            border-top: 3px solid #ea580c;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #d4a373; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #bc8a5f; }
        
        /* Magnetic Button Base Style */
        .magnetic-button {
            display: inline-flex; /* Important for transform to work correctly */
            position: relative;
            z-index: 1;
            /* Ensure it doesn't get clipped easily */
            transform-style: preserve-3d;
            backface-visibility: hidden;
            will-change: transform;
        }
    </style>
</head>
<body class="bg-stone-50 text-stone-800 antialiased flex flex-col min-h-screen selection:bg-orange-100 selection:text-orange-900">

    <!-- Navigation -->
    <nav class="fixed w-full bg-white/95 backdrop-blur-md z-40 border-b border-stone-100 shadow-sm transition-all duration-300" id="navbar">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <!-- Logo -->
                <div class="flex-shrink-0 flex items-center">
                    <a href="#" class="flex flex-col group">
                        <span class="text-2xl font-bold tracking-wider text-stone-900 italic group-hover:text-orange-600 transition-colors">Martini by Nidhi</span>
                        <span class="text-[10px] uppercase tracking-[0.2em] text-orange-600">Est. 2003 • Mumbai</span>
                    </a>
                </div>
                
                <!-- Desktop Menu -->
                <div class="hidden md:flex space-x-6 items-center">
                    <a href="#about" class="text-stone-600 hover:text-stone-900 text-sm font-medium transition-colors hover:scale-105 transform duration-200">About</a>
                    <a href="#categories" class="text-stone-600 hover:text-stone-900 text-sm font-medium transition-colors hover:scale-105 transform duration-200">Gifts</a>
                    <a href="#shop" class="text-stone-600 hover:text-stone-900 text-sm font-medium transition-colors hover:scale-105 transform duration-200">Shop</a>
                    
                    <!-- Cart Button (Desktop) -->
                    <button onclick="toggleCart()" class="relative p-2 text-stone-600 hover:text-orange-600 transition-colors hover:scale-110 active:scale-95 duration-200">
                        <i data-lucide="shopping-bag" class="w-6 h-6"></i>
                        <span id="cart-count-desktop" class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/4 -translate-y-1/4 bg-orange-600 rounded-full hidden shadow-sm">0</span>
                    </button>
                </div>

                <!-- Mobile Menu & Cart -->
                <div class="md:hidden flex items-center gap-4">
                    <button onclick="toggleCart()" class="relative p-2 text-stone-600 hover:text-stone-900 active:scale-95 transition-transform">
                        <i data-lucide="shopping-bag" class="w-6 h-6"></i>
                        <span id="cart-count-mobile" class="absolute top-0 right-0 inline-flex items-center justify-center px-2 py-1 text-xs font-bold leading-none text-white transform translate-x-1/4 -translate-y-1/4 bg-orange-600 rounded-full hidden shadow-sm">0</span>
                    </button>
                    <button id="mobile-menu-btn" class="text-stone-600 hover:text-stone-900 focus:outline-none p-2 active:scale-95 transition-transform">
                        <i data-lucide="menu" class="w-6 h-6"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Menu Panel -->
        <div id="mobile-menu" class="hidden md:hidden bg-white border-t border-stone-100 absolute w-full z-40 shadow-xl slide-down">
            <div class="px-4 pt-2 pb-6 space-y-2">
                <a href="#about" class="block px-3 py-3 text-stone-600 hover:bg-stone-50 rounded-lg active:bg-orange-50 transition-colors">About</a>
                <a href="#categories" class="block px-3 py-3 text-stone-600 hover:bg-stone-50 rounded-lg active:bg-orange-50 transition-colors">Gifts</a>
                <a href="#shop" class="block px-3 py-3 text-stone-600 hover:bg-stone-50 rounded-lg active:bg-orange-50 transition-colors">Shop All</a>
            </div>
        </div>
    </nav>

    <!-- Admin Panel (Hidden by default) -->
    <div id="admin-panel" class="hidden bg-stone-900 text-white py-4 px-6 mt-20 border-b border-orange-500 relative z-30">
        <div class="max-w-7xl mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <h3 class="text-lg font-bold flex items-center gap-2">
                <i data-lucide="shield-check" class="text-orange-500"></i> Admin Dashboard
            </h3>
            <div class="flex gap-3 w-full md:w-auto">
                <button onclick="toggleAddProductModal()" class="magnetic-button flex-1 md:flex-none bg-orange-600 hover:bg-orange-700 text-white px-4 py-2 rounded-md text-sm font-medium transition-colors flex items-center justify-center gap-2">
                    <i data-lucide="plus-circle" class="w-4 h-4"></i> Add Product
                </button>
                <button onclick="logoutAdmin()" class="flex-1 md:flex-none bg-stone-700 hover:bg-stone-600 text-white px-4 py-2 rounded-md text-sm font-medium transition-all active:scale-95">
                    Logout
                </button>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <header class="relative pt-32 pb-20 lg:pt-48 lg:pb-32 overflow-hidden">
        <div class="absolute inset-0 z-0 opacity-10 bg-[url('https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?q=80&w=2070&auto=format&fit=crop')] bg-cover bg-center"></div>
        
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10 text-center fade-in">
            <div class="inline-flex items-center gap-2 py-1 px-4 rounded-full bg-orange-100 text-orange-900 text-sm font-bold tracking-wide mb-6 shadow-sm">
                <i data-lucide="crown" class="w-4 h-4"></i> Registered Since 2003
            </div>
            <!-- Responsive Font Size -->
            <h1 class="text-4xl md:text-5xl lg:text-7xl font-bold text-stone-900 mb-6 leading-tight tracking-tight">
                Turning Ideas <br> Into Reality
            </h1>
            <p class="mt-4 max-w-3xl mx-auto text-lg md:text-xl text-stone-600 leading-relaxed font-light px-4">
                From <strong>Bespoke Baby Shower Hampers</strong> to <strong>Complete Wedding Branding</strong>. 
                We are Mumbai's premier creators of memories.
            </p>
            <div class="mt-10 flex flex-col sm:flex-row justify-center gap-4 px-4">
                <!-- Magnetic Buttons Applied Here -->
                <a href="#shop" class="magnetic-button px-8 py-3.5 bg-stone-900 text-white rounded-full text-lg font-medium hover:bg-stone-800 transition-colors shadow-lg hover:shadow-xl w-full sm:w-auto text-center justify-center">
                    Shop Collections
                </a>
                <a href="#categories" class="magnetic-button px-8 py-3.5 bg-white text-stone-900 border border-stone-200 rounded-full text-lg font-medium hover:bg-stone-50 transition-colors w-full sm:w-auto text-center justify-center">
                    View Gifts
                </a>
            </div>
        </div>
    </header>

    <!-- FNP-Style Categories Grid -->
    <section id="categories" class="py-12 md:py-16 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-8 md:mb-12">
                <h2 class="text-3xl font-bold text-stone-900">Gift Collections</h2>
                <p class="text-stone-500 mt-2">Find the perfect gift for every moment.</p>
            </div>
            
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
                <!-- Baby Shower -->
                <a href="#shop" onclick="filterCategory('Baby Shower')" class="group cursor-pointer transform hover:-translate-y-1 transition-all duration-300">
                    <div class="relative rounded-2xl overflow-hidden aspect-[4/5] shadow-md group-hover:shadow-xl transition-shadow">
                        <img src="https://images.unsplash.com/photo-1519689680058-324335c77eba?q=80&w=2070&auto=format&fit=crop" loading="lazy" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
                        <div class="absolute bottom-5 left-5 text-white">
                            <h3 class="font-bold text-2xl mb-1">Baby Shower</h3>
                            <p class="text-white/80 text-sm flex items-center gap-1 group-hover:translate-x-2 transition-transform">Explore Gifts <i data-lucide="arrow-right" class="w-4 h-4"></i></p>
                        </div>
                    </div>
                </a>

                <!-- Corporate -->
                <a href="#shop" onclick="filterCategory('Corporate')" class="group cursor-pointer transform hover:-translate-y-1 transition-all duration-300">
                    <div class="relative rounded-2xl overflow-hidden aspect-[4/5] shadow-md group-hover:shadow-xl transition-shadow">
                        <img src="https://images.unsplash.com/photo-1543269664-56d93c1b41a6?q=80&w=2070&auto=format&fit=crop" loading="lazy" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
                        <div class="absolute bottom-5 left-5 text-white">
                            <h3 class="font-bold text-2xl mb-1">Corporate</h3>
                            <p class="text-white/80 text-sm flex items-center gap-1 group-hover:translate-x-2 transition-transform">Explore Gifts <i data-lucide="arrow-right" class="w-4 h-4"></i></p>
                        </div>
                    </div>
                </a>

                <!-- Weddings -->
                <a href="#shop" onclick="filterCategory('Wedding')" class="group cursor-pointer transform hover:-translate-y-1 transition-all duration-300">
                    <div class="relative rounded-2xl overflow-hidden aspect-[4/5] shadow-md group-hover:shadow-xl transition-shadow">
                        <img src="https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?q=80&w=2070&auto=format&fit=crop" loading="lazy" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
                        <div class="absolute bottom-5 left-5 text-white">
                            <h3 class="font-bold text-2xl mb-1">Weddings</h3>
                            <p class="text-white/80 text-sm flex items-center gap-1 group-hover:translate-x-2 transition-transform">Explore Gifts <i data-lucide="arrow-right" class="w-4 h-4"></i></p>
                        </div>
                    </div>
                </a>

                <!-- Housewarming -->
                <a href="#shop" onclick="filterCategory('Housewarming')" class="group cursor-pointer transform hover:-translate-y-1 transition-all duration-300">
                    <div class="relative rounded-2xl overflow-hidden aspect-[4/5] shadow-md group-hover:shadow-xl transition-shadow">
                        <img src="https://images.unsplash.com/photo-1560185007-cde436f6a4d0?q=80&w=2070&auto=format&fit=crop" loading="lazy" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
                        <div class="absolute bottom-5 left-5 text-white">
                            <h3 class="font-bold text-2xl mb-1">Housewarming</h3>
                            <p class="text-white/80 text-sm flex items-center gap-1 group-hover:translate-x-2 transition-transform">Explore Gifts <i data-lucide="arrow-right" class="w-4 h-4"></i></p>
                        </div>
                    </div>
                </a>

                <!-- Naming Ceremony -->
                <a href="#shop" onclick="filterCategory('Naming Ceremony')" class="group cursor-pointer transform hover:-translate-y-1 transition-all duration-300">
                    <div class="relative rounded-2xl overflow-hidden aspect-[4/5] shadow-md group-hover:shadow-xl transition-shadow">
                        <img src="https://images.unsplash.com/photo-1513519245088-0e12902e5a38?q=80&w=2070&auto=format&fit=crop" loading="lazy" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
                        <div class="absolute bottom-5 left-5 text-white">
                            <h3 class="font-bold text-2xl mb-1">Naming Ceremony</h3>
                            <p class="text-white/80 text-sm flex items-center gap-1 group-hover:translate-x-2 transition-transform">Explore Gifts <i data-lucide="arrow-right" class="w-4 h-4"></i></p>
                        </div>
                    </div>
                </a>

                <!-- Hampers -->
                <a href="#shop" onclick="filterCategory('Hamper')" class="group cursor-pointer transform hover:-translate-y-1 transition-all duration-300">
                    <div class="relative rounded-2xl overflow-hidden aspect-[4/5] shadow-md group-hover:shadow-xl transition-shadow">
                        <img src="https://images.unsplash.com/photo-1608248597279-f99d160bfbc8?q=80&w=2070&auto=format&fit=crop" loading="lazy" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700">
                        <div class="absolute inset-0 bg-gradient-to-t from-black/70 via-black/20 to-transparent"></div>
                        <div class="absolute bottom-5 left-5 text-white">
                            <h3 class="font-bold text-2xl mb-1">Gift Hampers</h3>
                            <p class="text-white/80 text-sm flex items-center gap-1 group-hover:translate-x-2 transition-transform">Explore Gifts <i data-lucide="arrow-right" class="w-4 h-4"></i></p>
                        </div>
                    </div>
                </a>
            </div>
        </div>
    </section>

    <!-- Shop Section -->
    <section id="shop" class="py-12 md:py-20 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col md:flex-row justify-between items-end mb-12 gap-4">
                <div>
                    <h2 class="text-3xl md:text-5xl font-bold text-stone-900">Featured Products</h2>
                    <p class="text-stone-500 mt-4 max-w-2xl">Handcrafted with love in Mumbai.</p>
                </div>
                <!-- Filter -->
                <div class="w-full md:w-auto">
                    <div class="relative">
                        <i data-lucide="filter" class="absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-stone-400"></i>
                        <select id="shop-filter" onchange="applyFilter()" class="w-full md:w-auto pl-10 pr-8 py-3 bg-stone-50 border border-stone-200 rounded-lg text-stone-800 focus:outline-none focus:ring-2 focus:ring-orange-500 appearance-none cursor-pointer hover:bg-stone-100 transition-colors text-base">
                            <option value="All">All Gifts</option>
                            <option value="Baby Shower">Baby Shower</option>
                            <option value="Wedding">Wedding</option>
                            <option value="Corporate">Corporate</option>
                            <option value="Hamper">Hampers</option>
                            <option value="Crystal">Crystal Healing</option>
                            <option value="Housewarming">Housewarming</option>
                            <option value="Naming Ceremony">Naming Ceremony</option>
                        </select>
                        <i data-lucide="chevron-down" class="absolute right-3 top-1/2 -translate-y-1/2 w-4 h-4 text-stone-400 pointer-events-none"></i>
                    </div>
                </div>
            </div>
            
            <!-- Product Grid -->
            <div id="products-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 md:gap-8">
                <!-- Loading State -->
                <div class="col-span-full flex justify-center py-12">
                    <div class="loader"></div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-stone-900 text-stone-300 pt-16 pb-8 mt-auto">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid md:grid-cols-3 gap-12 mb-12 border-b border-stone-800 pb-12">
                <div>
                    <h3 class="text-2xl font-serif italic mb-4 text-white">Martini by Nidhi</h3>
                    <p class="text-sm text-stone-500 mb-4 leading-relaxed">
                        Turning ideas into reality since 2003. We specialize in turning your special moments into lifelong memories through bespoke gifting and styling.
                    </p>
                </div>
                <div>
                    <h4 class="text-white font-bold uppercase tracking-widest text-xs mb-4">Quick Links</h4>
                    <ul class="space-y-3 text-sm text-stone-400">
                        <li><a href="#shop" onclick="filterCategory('Baby Shower')" class="hover:text-orange-500 cursor-pointer flex items-center gap-2"><i data-lucide="chevron-right" class="w-3 h-3"></i> Baby Shower Gifts</a></li>
                        <li><a href="#shop" onclick="filterCategory('Corporate')" class="hover:text-orange-500 cursor-pointer flex items-center gap-2"><i data-lucide="chevron-right" class="w-3 h-3"></i> Corporate Gifting</a></li>
                        <li><a href="#shop" onclick="filterCategory('Wedding')" class="hover:text-orange-500 cursor-pointer flex items-center gap-2"><i data-lucide="chevron-right" class="w-3 h-3"></i> Wedding Favors</a></li>
                    </ul>
                </div>
                <div>
                    <h4 class="text-white font-bold uppercase tracking-widest text-xs mb-4">Contact Us</h4>
                    <p class="text-sm text-stone-400 mb-2">Mumbai, Maharashtra</p>
                    <div class="flex gap-4 mt-6">
                        <a href="https://www.instagram.com/martinibynidhi" target="_blank" class="w-10 h-10 rounded-full bg-stone-800 flex items-center justify-center text-stone-400 hover:bg-orange-600 hover:text-white transition-all active:scale-95"><i data-lucide="instagram" class="w-5 h-5"></i></a>
                        <a href="mailto:contact@martinibynidhi.com" class="w-10 h-10 rounded-full bg-stone-800 flex items-center justify-center text-stone-400 hover:bg-orange-600 hover:text-white transition-all active:scale-95"><i data-lucide="mail" class="w-5 h-5"></i></a>
                        <a href="#" class="w-10 h-10 rounded-full bg-stone-800 flex items-center justify-center text-stone-400 hover:bg-orange-600 hover:text-white transition-all active:scale-95"><i data-lucide="facebook" class="w-5 h-5"></i></a>
                    </div>
                </div>
            </div>
            
            <div class="text-center">
                <button onclick="adminLogin()" class="magnetic-button inline-flex items-center gap-2 px-6 py-2 bg-stone-800 text-stone-400 hover:text-white rounded-full text-xs uppercase tracking-widest transition-colors mb-4 border border-stone-700 active:scale-95">
                    <i data-lucide="lock" class="w-3 h-3"></i> Admin Login
                </button>
                <p class="text-stone-500 text-sm">&copy; 2024 Martini by Nidhi. All rights reserved. Mumbai.</p>
            </div>
        </div>
    </footer>

    <!-- ADD PRODUCT MODAL (Z-Index 60 to sit above everything) -->
    <div id="add-product-modal" class="fixed inset-0 bg-black/60 z-[60] hidden flex items-end sm:items-center justify-center p-0 sm:p-4 backdrop-blur-sm transition-opacity">
        <div class="bg-white rounded-t-2xl sm:rounded-xl shadow-2xl max-w-md w-full p-6 animate-fade-in-up max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-stone-900">Add New Product</h3>
                <button onclick="toggleAddProductModal()" class="p-2 hover:bg-stone-100 rounded-full text-stone-400 hover:text-stone-600 transition-colors"><i data-lucide="x"></i></button>
            </div>
            <form id="add-product-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-1">Product Name</label>
                    <input type="text" id="p-name" required class="w-full px-3 py-3 text-base border border-stone-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:outline-none">
                </div>
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-1">Description</label>
                    <textarea id="p-desc" rows="2" required class="w-full px-3 py-3 text-base border border-stone-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:outline-none"></textarea>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium text-stone-700 mb-1">Price (₹)</label>
                        <input type="number" id="p-price" required class="w-full px-3 py-3 text-base border border-stone-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:outline-none">
                    </div>
                    <div>
                         <label class="block text-sm font-medium text-stone-700 mb-1">Category</label>
                        <select id="p-category" class="w-full px-3 py-3 text-base border border-stone-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:outline-none bg-white">
                            <option value="Baby Shower">Baby Shower</option>
                            <option value="Wedding">Wedding</option>
                            <option value="Corporate">Corporate</option>
                            <option value="Hamper">Hamper</option>
                            <option value="Housewarming">Housewarming</option>
                            <option value="Naming Ceremony">Naming Ceremony</option>
                            <option value="Crystal">Crystal</option>
                            <option value="Candle">Candle</option>
                        </select>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-1">Image URL</label>
                    <input type="url" id="p-image" placeholder="https://..." required class="w-full px-3 py-3 text-base border border-stone-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:outline-none">
                    <p class="text-xs text-stone-500 mt-1">Paste a link from Unsplash or your image host.</p>
                </div>
                <button type="submit" class="w-full bg-stone-900 text-white py-4 rounded-lg font-bold hover:bg-stone-800 transition-all active:scale-95 shadow-lg mt-2">
                    Add Product
                </button>
            </form>
        </div>
    </div>

    <!-- LOGIN MODAL (Z-Index 60) -->
    <div id="login-modal" class="fixed inset-0 bg-black/60 z-[60] hidden flex items-center justify-center p-4 backdrop-blur-sm">
        <div class="bg-white rounded-xl shadow-2xl max-w-sm w-full p-6 animate-fade-in-up">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-xl font-bold text-stone-900">Admin Access</h3>
                <button onclick="toggleLoginModal()" class="p-2 hover:bg-stone-100 rounded-full text-stone-400 hover:text-stone-600"><i data-lucide="x"></i></button>
            </div>
            <form id="login-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-stone-700 mb-1">Password</label>
                    <input type="password" id="admin-pass" required placeholder="Enter admin password" class="w-full px-3 py-3 text-base border border-stone-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:outline-none">
                    <p id="login-error" class="text-xs text-red-500 mt-1 hidden">Incorrect password. Try 'admin123'</p>
                </div>
                <button type="submit" class="w-full bg-stone-900 text-white py-3 rounded-lg font-bold hover:bg-stone-800 transition-all active:scale-95 shadow-md">
                    Login
                </button>
            </form>
        </div>
    </div>

    <!-- CART SIDEBAR (Z-Index 60 to sit above nav) -->
    <div id="cart-sidebar" class="fixed inset-y-0 right-0 w-full md:w-96 bg-white shadow-2xl transform translate-x-full transition-transform duration-300 z-[60] flex flex-col">
        <div class="p-5 border-b border-stone-100 flex justify-between items-center bg-stone-50 safe-top">
            <h2 class="text-xl font-bold text-stone-900 flex items-center gap-2">
                <i data-lucide="shopping-bag" class="text-orange-600"></i> Your Cart
            </h2>
            <button onclick="toggleCart()" class="p-2 hover:bg-stone-200 rounded-full transition-colors active:scale-95"><i data-lucide="x"></i></button>
        </div>
        
        <div id="cart-items" class="flex-1 overflow-y-auto p-5 space-y-4">
            <!-- Cart Items Injected Here -->
            <div class="flex flex-col items-center justify-center h-full text-stone-400 opacity-60">
                <i data-lucide="shopping-bag" class="w-12 h-12 mb-2"></i>
                <p>Your cart is empty.</p>
            </div>
        </div>

        <div class="p-6 border-t border-stone-100 bg-stone-50 safe-bottom">
            <div class="flex justify-between items-center mb-4 text-lg font-bold text-stone-900">
                <span>Total</span>
                <span id="cart-total">₹0</span>
            </div>
            <button onclick="checkout()" class="magnetic-button w-full bg-green-600 hover:bg-green-700 text-white py-4 rounded-xl font-bold transition-colors flex items-center justify-center gap-2 shadow-lg">
                <i data-lucide="message-circle" class="w-5 h-5"></i> Order via WhatsApp
            </button>
            <p class="text-xs text-stone-500 text-center mt-3">You will be redirected to WhatsApp to confirm your order.</p>
        </div>
    </div>
    
    <!-- Overlay for Cart/Modal (Z-Index 50 to sit above nav) -->
    <div id="overlay" onclick="closeAllDrawers()" class="fixed inset-0 bg-black/20 backdrop-blur-sm z-50 hidden transition-opacity"></div>

    <script>
        // --- 1. CONFIGURATION & STATE ---
        // TODO: Replace with your actual Firebase config object from the Firebase Console if running locally
        // See README.md for details
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {
            // apiKey: "YOUR_API_KEY",
            // authDomain: "YOUR_PROJECT_ID.firebaseapp.com",
            // projectId: "YOUR_PROJECT_ID",
            // storageBucket: "YOUR_PROJECT_ID.appspot.com",
            // messagingSenderId: "YOUR_SENDER_ID",
            // appId: "YOUR_APP_ID"
        };
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'martini-by-nidhi-local';
        
        let products = [];
        let filteredProducts = [];
        let cart = JSON.parse(localStorage.getItem('martini_cart')) || [];
        let isAdmin = localStorage.getItem('martini_admin') === 'true';

        // --- 2. FIREBASE LOGIC ---

        async function initApp() {
            try {
                // Handle Auth
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await auth.signInWithCustomToken(__initial_auth_token);
                } else {
                    await auth.signInAnonymously();
                }

                const productsRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('products');
                
                productsRef.onSnapshot((snapshot) => {
                    products = [];
                    snapshot.forEach(doc => {
                        products.push({ id: doc.id, ...doc.data() });
                    });
                    
                    if (products.length === 0 && isAdmin) {
                        seedData(productsRef);
                    }
                    
                    applyFilter(); // Initial render
                }, (error) => {
                    console.error("Error fetching products:", error);
                    document.getElementById('products-grid').innerHTML = '<p class="col-span-full text-center text-red-500">Error loading products. Check your Firebase config in index.html.</p>';
                });

            } catch (error) {
                console.error("Auth error:", error);
                 document.getElementById('products-grid').innerHTML = '<p class="col-span-full text-center text-red-500">Authentication Error. Check your Firebase config in index.html.</p>';
            }
        }

        async function addProductToDb(productData) {
            if (!auth.currentUser) return;
            try {
                const productsRef = db.collection('artifacts').doc(appId).collection('public').doc('data').collection('products');
                await productsRef.add({
                    ...productData,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                toggleAddProductModal();
                alert('Product added successfully!');
            } catch (e) {
                alert('Error adding product: ' + e.message);
            }
        }

        function seedData(ref) {
            const seeds = [
                { name: "Premium Baby Shower Hamper", price: 3499, category: "Baby Shower", imageUrl: "https://images.unsplash.com/photo-1519689680058-324335c77eba?q=80&w=2070&auto=format&fit=crop", description: "Curated essentials for the new mom and baby." },
                { name: "Rose Quartz Healing Set", price: 1299, category: "Crystal", imageUrl: "https://images.unsplash.com/photo-1615486377749-a29241b1d70d?q=80&w=1974&auto=format&fit=crop", description: "For relationship harmony and self-love." },
                { name: "Executive Corporate Box", price: 1800, category: "Corporate", imageUrl: "https://images.unsplash.com/photo-1543269664-56d93c1b41a6?q=80&w=2070&auto=format&fit=crop", description: "Premium desk essentials and gourmet treats." },
                { name: "Wedding Return Favors", price: 450, category: "Wedding", imageUrl: "https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?q=80&w=2070&auto=format&fit=crop", description: "Customized scented candles in gold tins." }
            ];
            seeds.forEach(s => ref.add(s));
        }

        // --- 3. UI RENDERING & FILTERING ---

        function filterCategory(categoryName) {
            const select = document.getElementById('shop-filter');
            let found = false;
            for(let i=0; i<select.options.length; i++) {
                if(select.options[i].value === categoryName || select.options[i].text.includes(categoryName)) {
                    select.selectedIndex = i;
                    found = true;
                    break;
                }
            }
            if(!found) select.value = "All";
            
            applyFilter();
            document.getElementById('shop').scrollIntoView({ behavior: 'smooth' });
        }

        function applyFilter() {
            const category = document.getElementById('shop-filter').value;
            
            if (category === "All") {
                filteredProducts = products;
            } else {
                filteredProducts = products.filter(p => p.category === category || p.category.includes(category));
            }
            renderProducts();
        }

        function renderProducts() {
            const grid = document.getElementById('products-grid');
            grid.innerHTML = '';

            if (filteredProducts.length === 0) {
                grid.innerHTML = `<div class="col-span-full text-center py-10 bg-stone-50 rounded-lg">
                    <p class="text-stone-500">No products found in this category.</p>
                </div>`;
                return;
            }

            filteredProducts.forEach(product => {
                const card = document.createElement('div');
                card.className = 'bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-xl transition-all duration-300 border border-stone-100 group flex flex-col transform hover:-translate-y-1';
                card.innerHTML = `
                    <div class="h-64 overflow-hidden relative">
                        <img src="${product.imageUrl || 'https://via.placeholder.com/400'}" alt="${product.name}" loading="lazy" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
                        <span class="absolute top-4 left-4 bg-white/90 backdrop-blur px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide text-stone-800 shadow-sm">
                            ${product.category}
                        </span>
                    </div>
                    <div class="p-6 flex-1 flex flex-col">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="text-xl font-bold text-stone-900">${product.name}</h3>
                            <span class="text-lg font-bold text-orange-600">₹${product.price}</span>
                        </div>
                        <p class="text-stone-600 text-sm mb-6 flex-1">${product.description}</p>
                        <button onclick="addToCart('${product.id}')" class="magnetic-button w-full py-3 border-2 border-stone-900 text-stone-900 font-bold rounded-lg hover:bg-stone-900 hover:text-white transition-colors flex justify-center items-center gap-2">
                            Add to Cart
                        </button>
                    </div>
                `;
                grid.appendChild(card);
            });
            lucide.createIcons();
            initMagneticButtons(); // Re-init for new buttons
        }

        function renderCart() {
            const container = document.getElementById('cart-items');
            const totalEl = document.getElementById('cart-total');
            const countDesktop = document.getElementById('cart-count-desktop');
            const countMobile = document.getElementById('cart-count-mobile');
            
            const count = cart.length;
            countDesktop.innerText = count;
            countMobile.innerText = count;
            countDesktop.classList.toggle('hidden', count === 0);
            countMobile.classList.toggle('hidden', count === 0);

            container.innerHTML = '';
            let total = 0;

            if (cart.length === 0) {
                container.innerHTML = `
                    <div class="flex flex-col items-center justify-center h-full text-stone-400 opacity-60">
                        <i data-lucide="shopping-bag" class="w-12 h-12 mb-2"></i>
                        <p>Your cart is empty.</p>
                    </div>`;
            } else {
                cart.forEach((item, index) => {
                    total += parseInt(item.price);
                    const itemEl = document.createElement('div');
                    itemEl.className = 'flex gap-4 items-center bg-stone-50 p-3 rounded-lg animate-fade-in border border-stone-100 shadow-sm';
                    itemEl.innerHTML = `
                        <img src="${item.imageUrl}" class="w-16 h-16 object-cover rounded-md">
                        <div class="flex-1">
                            <h4 class="font-bold text-stone-900 text-sm line-clamp-1">${item.name}</h4>
                            <p class="text-stone-600 text-xs">₹${item.price}</p>
                        </div>
                        <button onclick="removeFromCart(${index})" class="text-stone-400 hover:text-red-500 p-2 rounded-full hover:bg-white transition-colors"><i data-lucide="trash-2" class="w-4 h-4"></i></button>
                    `;
                    container.appendChild(itemEl);
                });
            }

            totalEl.innerText = '₹' + total;
            localStorage.setItem('martini_cart', JSON.stringify(cart));
            lucide.createIcons();
        }

        // --- 4. ANIMATION LOGIC (Magnetic Buttons) ---

        function initMagneticButtons() {
            const magnets = document.querySelectorAll('.magnetic-button');
            magnets.forEach((magnet) => {
                // Remove existing listeners if necessary (not strictly needed with replace behavior but good practice if complexity grows)
                // For this implementation, we just add listeners. 
                // Note: If you re-render items, old nodes are destroyed, so listener cleanup isn't crucial for simple cases.

                magnet.addEventListener('mousemove', function(e) {
                    const bounding = magnet.getBoundingClientRect();
                    const magnetsStrength = 0.4; // Pull strength
                    
                    // Calculate distance from center
                    const newX = ((e.clientX - bounding.left) / magnet.offsetWidth) - 0.5;
                    const newY = ((e.clientY - bounding.top) / magnet.offsetHeight) - 0.5;

                    // Move the button
                    gsap.to(magnet, {
                        duration: 1,
                        x: newX * magnet.offsetWidth * magnetsStrength,
                        y: newY * magnet.offsetHeight * magnetsStrength,
                        ease: 'power4.out'
                    });
                });

                magnet.addEventListener('mouseleave', function(e) {
                    gsap.to(magnet, {
                        duration: 1.5,
                        x: 0,
                        y: 0,
                        ease: 'elastic.out(1, 0.3)'
                    });
                });
            });
        }

        // --- 5. INTERACTIONS ---

        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                cart.push(product);
                renderCart();
                const btn = event.target;
                const originalText = btn.innerHTML;
                btn.innerHTML = `<i data-lucide="check" class="w-4 h-4"></i> Added`;
                btn.classList.add('bg-green-600', 'border-green-600', 'text-white');
                lucide.createIcons();
                setTimeout(() => {
                    btn.innerHTML = originalText;
                    btn.classList.remove('bg-green-600', 'border-green-600', 'text-white');
                    lucide.createIcons();
                    toggleCart(true); 
                }, 1000);
            }
        }

        function removeFromCart(index) {
            cart.splice(index, 1);
            renderCart();
        }

        function toggleCart(forceOpen = false) {
            const sidebar = document.getElementById('cart-sidebar');
            const overlay = document.getElementById('overlay');
            const isOpen = !sidebar.classList.contains('translate-x-full');

            if (isOpen && !forceOpen) {
                sidebar.classList.add('translate-x-full');
                overlay.classList.add('hidden');
                document.body.style.overflow = ''; // Restore scrolling
            } else {
                sidebar.classList.remove('translate-x-full');
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // Lock scrolling
                // Close mobile menu if open
                document.getElementById('mobile-menu').classList.add('hidden');
            }
        }

        function closeAllDrawers() {
            document.getElementById('cart-sidebar').classList.add('translate-x-full');
            document.getElementById('overlay').classList.add('hidden');
            document.getElementById('mobile-menu').classList.add('hidden');
            document.getElementById('login-modal').classList.add('hidden');
            document.getElementById('add-product-modal').classList.add('hidden');
            document.body.style.overflow = ''; // Restore scrolling
        }

        function checkout() {
            if (cart.length === 0) return alert('Cart is empty!');
            let message = "Hi Martini by Nidhi! I'd like to place an order:%0A%0A";
            let total = 0;
            cart.forEach(item => {
                message += `• ${item.name} - ₹${item.price}%0A`;
                total += parseInt(item.price);
            });
            message += `%0A*Total: ₹${total}*`;
            const phoneNumber = "919876543210"; 
            window.open(`https://wa.me/${phoneNumber}?text=${message}`, '_blank');
        }

        // --- 6. ADMIN LOGIC ---

        function adminLogin() {
            if(isAdmin) {
                window.scrollTo({ top: 0, behavior: 'smooth' });
                return;
            }
            toggleLoginModal();
        }

        function toggleLoginModal() {
            const modal = document.getElementById('login-modal');
            const overlay = document.getElementById('overlay');
            
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
                document.getElementById('admin-pass').value = '';
                document.getElementById('login-error').classList.add('hidden');
                document.getElementById('admin-pass').focus();
            } else {
                modal.classList.add('hidden');
                overlay.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }

        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const pass = document.getElementById('admin-pass').value;
            if (pass === "admin123") {
                localStorage.setItem('martini_admin', 'true');
                isAdmin = true;
                checkAdminStatus();
                toggleLoginModal();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            } else {
                document.getElementById('login-error').classList.remove('hidden');
            }
        });

        function logoutAdmin() {
            localStorage.removeItem('martini_admin');
            isAdmin = false;
            checkAdminStatus();
        }

        function checkAdminStatus() {
            const panel = document.getElementById('admin-panel');
            if (isAdmin) {
                panel.classList.remove('hidden');
                initApp(); 
            } else {
                panel.classList.add('hidden');
            }
        }

        function toggleAddProductModal() {
            const modal = document.getElementById('add-product-modal');
            const overlay = document.getElementById('overlay');
            
            if (modal.classList.contains('hidden')) {
                modal.classList.remove('hidden');
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            } else {
                modal.classList.add('hidden');
                overlay.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }
        
        document.getElementById('add-product-form').addEventListener('submit', (e) => {
            e.preventDefault();
            const data = {
                name: document.getElementById('p-name').value,
                description: document.getElementById('p-desc').value,
                price: parseFloat(document.getElementById('p-price').value),
                imageUrl: document.getElementById('p-image').value,
                category: document.getElementById('p-category').value,
            };
            addProductToDb(data);
            e.target.reset();
        });

        // --- 7. INITIALIZATION ---
        
        document.getElementById('mobile-menu-btn').addEventListener('click', () => {
            const menu = document.getElementById('mobile-menu');
            const isHidden = menu.classList.contains('hidden');
            
            if(isHidden) {
                menu.classList.remove('hidden');
                document.body.style.overflow = 'hidden'; // Lock
            } else {
                menu.classList.add('hidden');
                document.body.style.overflow = ''; // Unlock
            }
        });

        // Close mobile menu when clicking links
        document.querySelectorAll('#mobile-menu a').forEach(link => {
            link.addEventListener('click', () => {
                document.getElementById('mobile-menu').classList.add('hidden');
                document.body.style.overflow = '';
            });
        });
        
        // Initial Init
        lucide.createIcons();
        checkAdminStatus();
        initApp();
        renderCart();
        // Init magnetic buttons for static elements
        initMagneticButtons();

    </script>
</body>
</html>